There seems to be some duplication in loop bodies
